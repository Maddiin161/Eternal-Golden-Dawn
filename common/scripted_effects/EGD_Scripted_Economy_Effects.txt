EGD_CALCULATE_GDP_MONTHLY = {
	custom_effect_tooltip = EGD_economy_debug1_tooltip
	EGD_CALCULATE_GDP = yes
	set_temp_variable = { real_inflation = EGD_COUNTRY_INFLATION_BASE }
	subtract_from_temp_variable = { real_inflation = EGD_COUNTRY_INTEREST_RATE }
	
	set_temp_variable = { gdp_interest_rate_calc = EGD_COUNTRY_INTEREST_RATE }
	divide_temp_variable = { gdp_interest_rate_calc = 10 }
	
	set_temp_variable = { gdp_growth_calc = EGD_COUNTRY_GDP_GROWTH }
	subtract_from_temp_variable = { gdp_growth_calc = gdp_interest_rate_calc }
	subtract_from_temp_variable = { gdp_growth_calc = real_inflation }
	set_variable = { EGD_COUNTRY_REAL_GROWTH_RATE = gdp_growth_calc }

	set_temp_variable = { gdp_real_growth_calc = EGD_COUNTRY_REAL_GROWTH_RATE }
	add_to_temp_variable = { gdp_real_growth_calc = 1 }
	multiply_variable = { EGD_COUNTRY_GDP = gdp_real_growth_calc }
	
}

EGD_calculate_GDP_PER_CAPITA = {
	set_temp_variable = { actual_core_manpower_k = 0 }

	every_owned_state = {
		limit = { is_core_of = PREV }
		add_to_temp_variable = { PREV.actual_core_manpower_k = state_population_k }
	}
	
	set_variable = { EGD_GDP_PER_CAPITA = EGD_COUNTRY_GDP }
	multiply_variable = { EGD_GDP_PER_CAPITA = 1000 }
	divide_variable = { EGD_GDP_PER_CAPITA = actual_core_manpower_k }
	multiply_variable = { EGD_GDP_PER_CAPITA = 1000 }
	clamp_variable = { var = EGD_GDP_PER_CAPITA min = 0 }
	
}
EGD_CALCULATE_GDP = {
	set_temp_variable = { actual_core_manpower_k = 0 }
	set_temp_variable = { office_park_amount = 0 }
	
	every_owned_state = {
		limit = { is_core_of = PREV }
		add_to_temp_variable = { PREV.actual_core_manpower_k = state_population_k }
		add_to_temp_variable = { PREV.office_park_amount = building_level@office_park }
	}

	set_temp_variable = { temp_civ = num_of_civilian_factories }
	set_temp_variable = { temp_mil = num_of_military_factories }

	set_variable = { EGD_COUNTRY_GDP = temp_civ }

	clamp_temp_variable = { var = temp_civ min = 1 max = 1000 }

	set_temp_variable = { temp = temp_civ }
	multiply_temp_variable = { temp = 8 }
	add_to_variable = { EGD_COUNTRY_GDP = temp }

	set_temp_variable = { temp = temp_mil }
	multiply_temp_variable = { temp = 4 }
	add_to_variable = { EGD_COUNTRY_GDP = temp }

	set_temp_variable = { temp = office_park_amount }
	multiply_temp_variable = { temp = modifier@office_park_income_rate }
	multiply_temp_variable = { temp = 6 }
	add_to_variable = { EGD_COUNTRY_GDP = temp }

	
	set_variable = { EGD_COUNTRY_GDP_PER_CAPITA = EGD_COUNTRY_GDP }
	multiply_variable = { EGD_COUNTRY_GDP_PER_CAPITA = 1000 }
	divide_variable = { EGD_COUNTRY_GDP_PER_CAPITA = actual_core_manpower_k }
	multiply_variable = { EGD_COUNTRY_GDP_PER_CAPITA = 1000 }
	clamp_variable = { var = EGD_COUNTRY_GDP_PER_CAPITA min = 0 }
}

EGD_startup = {
	every_country = {
			if = {
				limit = {
					check_variable = { EGD_COUNTRY_GDP > 999 }
				}
				add_ideas = superpower
			}
			else_if = {
				limit = {
					check_variable = { EGD_COUNTRY_GDP > 499 }
				}
				add_ideas = rising_superpower
			}
			else_if = {
				limit = {
					check_variable = { EGD_COUNTRY_GDP > 249 }
				}
				add_ideas = powerful_economy
			}
			else_if = {
				limit = {
					check_variable = { EGD_COUNTRY_GDP > 99 }
				}
				add_ideas = medium_economy
			}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP > 49 }
			}
			add_ideas = smaller_economy
		}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP > 49 }
				NOT = { has_country_flag = is_smol_country }
			}
			add_ideas = poor_economy
		}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP > 24 }
				has_country_flag = is_smol_country
			}
			add_ideas = very_small_economy
		}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP < 24 }
				has_country_flag = is_smol_country
			}
			add_ideas = very_very_small_economy
		}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP < 24 }
				NOT = { has_country_flag = is_smol_country }
			}
			add_ideas = basket_case_economy
		}
		else_if = {
			limit = {
				check_variable = { EGD_COUNTRY_GDP < 12 }
				NOT = { has_country_flag = is_smol_country }
			}
			add_ideas = warlord_economy
		}
	}
}

EGD_startup_calc = {
	every_country = {
		set_variable = { GDP_trillion = var:EGD_COUNTRY_GDP }
		set_variable = { GDP_million = var:EGD_COUNTRY_GDP }
		multiply_variable = { GDP_trillion = 0.001 }
		multiply_variable = { GDP_million = 1000 }
		multiply_variable = { REAL_GROWTH = 0.01}
		set_variable = { DEBT_trillion = var:EGD_COUNTRY_DEBT }
		set_variable = { DEBT_million = var:EGD_COUNTRY_DEBT }
		multiply_variable = { DEBT_trillion = 0.001 }
		multiply_variable = { DEBT_million = 1000 }
		EGD_calculate_GDP_PER_CAPITA = yes
	}
}


